<html>
<head>
<title>올더게이트</title>
<style type="text/css">
<!--
body { font-family:"돋움"; font-size:9pt; color:#333333; font-weight:normal; letter-spacing:0pt; line-height:180%; }
td { font-family:"돋움"; font-size:9pt; color:#333333; font-weight:normal; letter-spacing:0pt; line-height:180%; }
.clsright { padding-right:10px; text-align:right; }
.clsleft { padding-left:10px; text-align:left; }
.formbox_input {background-color:#FFFFFF; height:19px; font: 12px; margin:0px; "Verdana", "돋움"; color:#39393D;  border: 1 solid #CFCFCF;}
-->
</style>
<script language="javascript">
function Cancel(form)
{
	if(Check_Common(form) == true)
	{
		if(confirm("자동이체 회원에 대한 취소처리를 하시겠습니까?") == true)
		{ 
			var openwin = window.open("AGS_progress.html","popup","width=300,height=160");
			
			var data = "M" + form.PayType.value +"|"+ form.StoreId.value +"|"+ form.MonthPayNo.value +"|"+ form.ProductAmount.value+ "|";

			var datalength = calculateBytes(data);

			var showlength = "";
			
			if(datalength.length = 1){
				showlength = "0000" + datalength;
			}else if(datalength.length = 2){
				showlength = "000" + datalength;
			}else if(datalength.length = 3){
				showlength = "00" + datalength;
			}else if(datalength.length = 4){
				showlength = "0" + datalength;
			}

			form.SendData.value = showlength + data;
			
			form.submit();
		}
	}
} 

function calculateBytes(szValue)
{
	var tcount = 0;

	var tmpStr = new String(szValue);
	var temp = tmpStr.length;

	var onechar;
	for ( k=0; k<temp; k++ )
	{
		onechar = tmpStr.charAt(k);
		if (escape(onechar).length > 4)
	    {
			tcount += 2;
	    }
		else
	    {
			tcount += 1;
	    }
	}
	return tcount;
}

function Check_Common(form) 
{
	if(form.StoreId.value == "")
	{
		alert("상점아이디를 입력하십시오.");
		return false;
	}
	else if(form.MonthPayNo.value == "")
	{
		alert("회원번호를 입력하십시오.");
		return false;
	}
	else if(form.MonthPayNo.value.length != 17)
	{
		alert("정확한 회원번호를 입력하십시오.");
		return false;
	}
	else if(form.ProductAmount.value == "")
	{
		alert("결제금액을 입력하십시오.");
		return false;
	}
	return true;
}
</script>
</head>
<body topmargin=0 leftmargin=0 rightmargin=0 bottommargin=0>
<form name=frmAGS_cancel method=post action=ags5ing.php>
<table border=0 width=100% height=100% cellpadding=0 cellspacing=0>
	<tr>
		<td align=center>
		<table width=650 border=0 cellpadding=0 cellspacing=0>
			<tr>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td><hr></td>
			</tr>
			<tr>
				<td class=clsleft><b>자동이체 취소요청 테스트페이지</b></td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td class=clsleft>
				1) 본 취소요청 페이지를 상점에 맞게 적절하게 수정하여 사용하십시오.<br>
				2) 본 페이지는 자동이체를 사용중인 고객이 중도 해지할 경우 잔금처리를 위한 용도로 개발 되었습니다. 단, 신용카드 자동이체만 잔금처리가 가능합니다.<br>
				3) 중도 해지시 납부해야하는 금액이 있을 경우 해당금액을 아래의 결제 금액 필드에 넣어주시고 남은 금액이 없는 경우 "0"원으로 값을 셋팅하여 넘겨 주시기 바랍니다.(추가 납부가 필요 없는 경우 0원 처리!!)<br>
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td class=clsleft>☞ 표시는 필수 입력사항입니다. </td>
			</tr>
			<tr>
				<td><hr></td>
			</tr>
			<tr>
				<td>
				<table width=650 border=0 cellpadding=0 cellspacing=0>
					<tr>
						<td class=clsleft width=170>☞ 상점아이디 (20)</td>
						<!--상점아이디를 실거래 전환후에는 발급받은 아이디로 바꾸시기 바랍니다.-->
						<td width=200><input class=formbox_input type=text style=width:100px name=StoreId maxlength=20 value="aegis"></td>
						<td width=280></td>
					</tr>
					<tr>
						<td class=clsleft>☞ 회원번호 (17)</td>
						<td><input type=text class=formbox_input style=width:200px name=MonthPayNo maxlength=17 value="AGS20200130000001"></td>
						<td></td>
					</tr>
					<tr>
						<td class=clsleft>☞ 결제금액 (12)</td>
						<td><input type=text class=formbox_input style=width:100px name=ProductAmount maxlength=12 value="1000"></td>
						<td>추가 납부 없을 경우 0원 입력</td>
					</tr>
				</table>
				</td>
			</tr>
			<tr>
				<td><hr></td> 
			</tr>
			<tr>
				<td align=center>
				<input type="button" value="취소요청" onclick="javascript:Cancel(frmAGS_cancel);">
				<!--
				<a href="javascript:Cancel(frmAGS_cancel);"><img src="button.gif" border="0"></a>
				-->
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
		</td>
	</tr>
</table>

<!-- 스크립트 및 플러그인에서 값을 설정하는 Hidden 필드  !!수정을 하시거나 삭제하지 마십시오-->

<input type=hidden name=ServerIP value="220.85.12.74">	<!-- 올더게이트 통신 서버 IP설정 -->
<input type=hidden name=ServerPort value="29760">		<!-- 올더게이트 통신 서버 Port설정 -->
<input type=hidden name=ServerTimeOut value="30000">	<!-- 올더게이트 통신 서버 대기시간설정 -->
<input type=hidden name=PayType value="mpay_del">		<!-- 자동이체등록종류구분플래그 -->
<input type=hidden name=SendData value="">				<!-- 올더게이트로 전송할 데이터 필드 -->

<!-- 스크립트 및 플러그인에서 값을 설정하는 Hidden 필드  !!수정을 하시거나 삭제하지 마십시오-->

</form>
</body>
</html>